<form *ngIf="!showForgotPassword" (ngSubmit)="onSubmit()" #loginForm="ngForm" novalidate>
  <!-- Email -->
  <div class="mb-3">
    <label for="email" class="form-label">Email</label>
    <input type="email"
           class="form-control"
           id="email"
           name="email"
           [(ngModel)]="credentials.email"
           required
           pattern="^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$"
           #email="ngModel">
    
    <!-- Messages erreurs email -->
    <div *ngIf="email.touched && email.invalid" class="text-danger small mt-1">
      <div *ngIf="email.errors?.['required']">L'email est requis.</div>
      <div *ngIf="email.errors?.['pattern']">Format email invalide.</div>
    </div>
  </div>

  <!-- Mot de passe -->
  <div class="mb-3">
    <label for="password" class="form-label">Mot de passe</label>
    <input type="password"
           class="form-control"
           id="password"
           name="password"
           [(ngModel)]="credentials.password"
           required
           pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{4,8}$"
           #password="ngModel">

    <!-- Messages erreurs password -->
    <div *ngIf="password.touched && password.invalid" class="text-danger small mt-1">
      <div *ngIf="password.errors?.['required']">Le mot de passe est requis.</div>
      <div *ngIf="password.errors?.['pattern']">
        Le mot de passe doit contenir entre 4 et 8 caractères, avec au moins :
        une majuscule, une minuscule, un chiffre et un caractère spécial.
      </div>
    </div>
  </div>

  <!-- Erreur backend -->
  <div *ngIf="loginError" class="alert alert-danger small text-center">
    {{ loginError }}
  </div>

  <button type="submit"
          class="btn btn-primary w-100"
          [disabled]="loginForm.invalid || isLoading">
    <span *ngIf="isLoading" class="loading-spinner me-2"></span>
    Se connecter
  </button>

  <div class="text-center mt-2">
    <a href="#" (click)="toggleForgotPassword($event)">Mot de passe oublié ?</a>
  </div>
</form>
